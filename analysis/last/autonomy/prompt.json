{
  "architect_review": {
    "system": "Jesteś asystentem inżynierskim GlitchLab. Twoja analiza ma być deterministyczna, konkretna, bez wprowadzania losowości. Oceniaj wpływ zmian na architekturę i HUD/Mosaic⇄AST.",
    "user": "Cel: architect_review. Przygotuj plan refaktoryzacji i mapę ryzyk.\nRepo: . | LOC=41416, modules=199, defs=2036, classes=223.\nZidentyfikuj moduły krytyczne i zaproponuj kroki poprawy spójności.",
    "context": {
      "glx_state": {},
      "git_head": null,
      "recent_commits": [],
      "delta_last": [],
      "top_modules": [
        {
          "path": "glitchlab/gui/mosaic/hybrid_ast_mosaic.py",
          "loc": 1288,
          "defs": [
            {
              "name": "_rng_for_meta",
              "lineno": 149
            },
            {
              "name": "_meta_for",
              "lineno": 157
            },
            {
              "name": "ast_deltas",
              "lineno": 177
            },
            {
              "name": "add",
              "lineno": 185
            },
            {
              "name": "compress_ast",
              "lineno": 235
            },
            {
              "name": "build_mosaic_grid",
              "lineno": 266
            },
            {
              "name": "build_mosaic_hex",
              "lineno": 281
            },
            {
              "name": "build_mosaic",
              "lineno": 297
            },
            {
              "name": "region_ids",
              "lineno": 303
            },
            {
              "name": "_xy_of_idx",
              "lineno": 311
            },
            {
              "name": "_sigmoid",
              "lineno": 318
            },
            {
              "name": "_soft_label",
              "lineno": 328
            },
            {
              "name": "tile_dist",
              "lineno": 333
            },
            {
              "name": "_dm_greedy_oneway",
              "lineno": 350
            },
            {
              "name": "_length_penalty",
              "lineno": 364
            },
            {
              "name": "_pair_cost",
              "lineno": 378
            },
            {
              "name": "D_M",
              "lineno": 403
            },
            {
              "name": "phi_region_for",
              "lineno": 425
            },
            {
              "name": "phi_region_for_balanced",
              "lineno": 433
            },
            {
              "name": "phi_region_for_entropy",
              "lineno": 466
            },
            {
              "name": "near_thr",
              "lineno": 467
            },
            {
              "name": "load_policy_json",
              "lineno": 478
            },
            {
              "name": "make_selector_policy_aware",
              "lineno": 508
            },
            {
              "name": "_sel",
              "lineno": 524
            },
            {
              "name": "centroid",
              "lineno": 543
            },
            {
              "name": "phi_cost",
              "lineno": 551
            },
            {
              "name": "psi_feedback",
              "lineno": 572
            },
            {
              "name": "_neighbors_grid",
              "lineno": 599
            },
            {
              "name": "_neighbors_hex_oddr",
              "lineno": 609
            },
            {
              "name": "_adjacency_indices",
              "lineno": 622
            },
            {
              "name": "_connected_components",
              "lineno": 636
            },
            {
              "name": "mosaic_profile",
              "lineno": 670
            },
            {
              "name": "couple_alpha_beta",
              "lineno": 706
            },
            {
              "name": "distance_ast_mosaic",
              "lineno": 728
            },
            {
              "name": "invariants_check",
              "lineno": 735
            },
            {
              "name": "_selector_from_args",
              "lineno": 758
            },
            {
              "name": "run_once",
              "lineno": 771
            },
            {
              "name": "sweep",
              "lineno": 805
            },
            {
              "name": "sign_test_phi2_better",
              "lineno": 821
            },
            {
              "name": "_ast_summary_for_source_det",
              "lineno": 854
            },
            {
              "name": "_file_selector_filter",
              "lineno": 880
            },
            {
              "name": "run_from_git",
              "lineno": 890
            },
            {
              "name": "_pretty_table",
              "lineno": 1023
            },
            {
              "name": "rowfmt",
              "lineno": 1027
            },
            {
              "name": "line",
              "lineno": 1038
            },
            {
              "name": "cmd_run",
              "lineno": 1047
            },
            {
              "name": "cmd_sweep",
              "lineno": 1067
            },
            {
              "name": "cmd_test",
              "lineno": 1079
            },
            {
              "name": "_normpath_under_project",
              "lineno": 1092
            },
            {
              "name": "_emit_fallback_artifacts",
              "lineno": 1097
            },
            {
              "name": "cmd_from_git_dump",
              "lineno": 1149
            },
            {
              "name": "cmd_from_git",
              "lineno": 1210
            },
            {
              "name": "build_cli",
              "lineno": 1227
            },
            {
              "name": "main",
              "lineno": 1281
            }
          ],
          "classes": [
            {
              "name": "AstNode",
              "lineno": 126
            },
            {
              "name": "AstSummary",
              "lineno": 137
            },
            {
              "name": "Mosaic",
              "lineno": 255
            }
          ]
        },
        {
          "path": "glitchlab/gui/app.py",
          "loc": 913,
          "defs": [
            {
              "name": "init_styles",
              "lineno": 29
            },
            {
              "name": "__init__",
              "lineno": 85
            },
            {
              "name": "publish",
              "lineno": 86
            },
            {
              "name": "subscribe",
              "lineno": 87
            },
            {
              "name": "request",
              "lineno": 88
            },
            {
              "name": "__init__",
              "lineno": 112
            },
            {
              "name": "__init__",
              "lineno": 127
            },
            {
              "name": "_build_ui",
              "lineno": 163
            },
            {
              "name": "_init_sash",
              "lineno": 226
            },
            {
              "name": "_wire_bus",
              "lineno": 251
            },
            {
              "name": "_on_preset_parsed",
              "lineno": 318
            },
            {
              "name": "_load_image_path",
              "lineno": 327
            },
            {
              "name": "_save_image_path",
              "lineno": 374
            },
            {
              "name": "_pil_to_u8",
              "lineno": 393
            },
            {
              "name": "_array_to_pil",
              "lineno": 406
            },
            {
              "name": "run_step",
              "lineno": 420
            },
            {
              "name": "run_preset",
              "lineno": 457
            },
            {
              "name": "_on_progress",
              "lineno": 507
            },
            {
              "name": "_on_run_done",
              "lineno": 519
            },
            {
              "name": "_on_run_error",
              "lineno": 556
            },
            {
              "name": "_update_bottom_from_cache",
              "lineno": 570
            },
            {
              "name": "_update_edit_menu_state",
              "lineno": 578
            },
            {
              "name": "_on_undo",
              "lineno": 586
            },
            {
              "name": "_on_redo",
              "lineno": 615
            },
            {
              "name": "_toggle_left",
              "lineno": 645
            },
            {
              "name": "_toggle_right",
              "lineno": 665
            },
            {
              "name": "_toggle_hud",
              "lineno": 681
            },
            {
              "name": "_toggle_fullscreen",
              "lineno": 697
            },
            {
              "name": "_get_active_layer_pil",
              "lineno": 711
            },
            {
              "name": "_get_composite_np",
              "lineno": 733
            },
            {
              "name": "_refresh_composite",
              "lineno": 748
            },
            {
              "name": "_layers_snapshot",
              "lineno": 761
            },
            {
              "name": "_calc_layers_sig",
              "lineno": 776
            },
            {
              "name": "_publish_layers_snapshot",
              "lineno": 785
            },
            {
              "name": "_on_layers_changed",
              "lineno": 798
            },
            {
              "name": "_on_layer_add",
              "lineno": 804
            },
            {
              "name": "_on_layer_remove",
              "lineno": 837
            },
            {
              "name": "_on_layer_set_active",
              "lineno": 848
            },
            {
              "name": "_on_layer_update",
              "lineno": 857
            },
            {
              "name": "_on_layers_reorder",
              "lineno": 874
            },
            {
              "name": "main",
              "lineno": 894
            }
          ],
          "classes": [
            {
              "name": "EventBus",
              "lineno": 84
            },
            {
              "name": "AppState",
              "lineno": 111
            },
            {
              "name": "App",
              "lineno": 126
            }
          ]
        },
        {
          "path": "glitchlab/gui/mosaic/tests/ast_mosaic_coupled.py",
          "loc": 732,
          "defs": [
            {
              "name": "energy",
              "lineno": 53
            },
            {
              "name": "entropy",
              "lineno": 57
            },
            {
              "name": "_node_label",
              "lineno": 75
            },
            {
              "name": "_attach_parents_and_depths",
              "lineno": 91
            },
            {
              "name": "walk",
              "lineno": 92
            },
            {
              "name": "_group_of",
              "lineno": 111
            },
            {
              "name": "_coords_for_tree",
              "lineno": 119
            },
            {
              "name": "walk",
              "lineno": 122
            },
            {
              "name": "_meta_for_node",
              "lineno": 148
            },
            {
              "name": "ast_nodes_from_code",
              "lineno": 164
            },
            {
              "name": "group_centroids",
              "lineno": 193
            },
            {
              "name": "coords_for_lambda",
              "lineno": 204
            },
            {
              "name": "build_base_mosaic",
              "lineno": 219
            },
            {
              "name": "_norm01",
              "lineno": 231
            },
            {
              "name": "_sobel_mag",
              "lineno": 238
            },
            {
              "name": "mosaic_from_ast",
              "lineno": 255
            },
            {
              "name": "_pos_lam",
              "lineno": 269
            },
            {
              "name": "region_indices",
              "lineno": 296
            },
            {
              "name": "region_centroid",
              "lineno": 302
            },
            {
              "name": "region_feats",
              "lineno": 310
            },
            {
              "name": "fuse_meta",
              "lineno": 322
            },
            {
              "name": "draw_ast",
              "lineno": 331
            },
            {
              "name": "draw_mosaic",
              "lineno": 345
            },
            {
              "name": "draw_region_frame",
              "lineno": 360
            },
            {
              "name": "draw_fusion",
              "lineno": 371
            },
            {
              "name": "draw_infographic",
              "lineno": 406
            },
            {
              "name": "__init__",
              "lineno": 445
            },
            {
              "name": "_font_step",
              "lineno": 540
            },
            {
              "name": "reset_views",
              "lineno": 547
            },
            {
              "name": "render",
              "lineno": 553
            },
            {
              "name": "on_lambda_changed",
              "lineno": 581
            },
            {
              "name": "on_node_changed",
              "lineno": 585
            },
            {
              "name": "recompute_mosaic_from_ast",
              "lineno": 590
            },
            {
              "name": "apply_feedback_and_recompute",
              "lineno": 609
            },
            {
              "name": "feats_at",
              "lineno": 618
            },
            {
              "name": "on_region_changed",
              "lineno": 641
            },
            {
              "name": "on_pick_ast",
              "lineno": 646
            },
            {
              "name": "on_click_any",
              "lineno": 656
            },
            {
              "name": "repaint",
              "lineno": 679
            },
            {
              "name": "main",
              "lineno": 725
            }
          ],
          "classes": [
            {
              "name": "AstNodeMeta",
              "lineno": 44
            },
            {
              "name": "Mosaic",
              "lineno": 62
            },
            {
              "name": "App",
              "lineno": 444
            }
          ]
        },
        {
          "path": "glitchlab/tests/ast_mosaic_coupled.py",
          "loc": 732,
          "defs": [
            {
              "name": "energy",
              "lineno": 53
            },
            {
              "name": "entropy",
              "lineno": 57
            },
            {
              "name": "_node_label",
              "lineno": 75
            },
            {
              "name": "_attach_parents_and_depths",
              "lineno": 91
            },
            {
              "name": "walk",
              "lineno": 92
            },
            {
              "name": "_group_of",
              "lineno": 111
            },
            {
              "name": "_coords_for_tree",
              "lineno": 119
            },
            {
              "name": "walk",
              "lineno": 122
            },
            {
              "name": "_meta_for_node",
              "lineno": 148
            },
            {
              "name": "ast_nodes_from_code",
              "lineno": 164
            },
            {
              "name": "group_centroids",
              "lineno": 193
            },
            {
              "name": "coords_for_lambda",
              "lineno": 204
            },
            {
              "name": "build_base_mosaic",
              "lineno": 219
            },
            {
              "name": "_norm01",
              "lineno": 231
            },
            {
              "name": "_sobel_mag",
              "lineno": 238
            },
            {
              "name": "mosaic_from_ast",
              "lineno": 255
            },
            {
              "name": "_pos_lam",
              "lineno": 269
            },
            {
              "name": "region_indices",
              "lineno": 296
            },
            {
              "name": "region_centroid",
              "lineno": 302
            },
            {
              "name": "region_feats",
              "lineno": 310
            },
            {
              "name": "fuse_meta",
              "lineno": 322
            },
            {
              "name": "draw_ast",
              "lineno": 331
            },
            {
              "name": "draw_mosaic",
              "lineno": 345
            },
            {
              "name": "draw_region_frame",
              "lineno": 360
            },
            {
              "name": "draw_fusion",
              "lineno": 371
            },
            {
              "name": "draw_infographic",
              "lineno": 406
            },
            {
              "name": "__init__",
              "lineno": 445
            },
            {
              "name": "_font_step",
              "lineno": 540
            },
            {
              "name": "reset_views",
              "lineno": 547
            },
            {
              "name": "render",
              "lineno": 553
            },
            {
              "name": "on_lambda_changed",
              "lineno": 581
            },
            {
              "name": "on_node_changed",
              "lineno": 585
            },
            {
              "name": "recompute_mosaic_from_ast",
              "lineno": 590
            },
            {
              "name": "apply_feedback_and_recompute",
              "lineno": 609
            },
            {
              "name": "feats_at",
              "lineno": 618
            },
            {
              "name": "on_region_changed",
              "lineno": 641
            },
            {
              "name": "on_pick_ast",
              "lineno": 646
            },
            {
              "name": "on_click_any",
              "lineno": 656
            },
            {
              "name": "repaint",
              "lineno": 679
            },
            {
              "name": "main",
              "lineno": 725
            }
          ],
          "classes": [
            {
              "name": "AstNodeMeta",
              "lineno": 44
            },
            {
              "name": "Mosaic",
              "lineno": 62
            },
            {
              "name": "App",
              "lineno": 444
            }
          ]
        },
        {
          "path": "glitchlab/.githooks/post-commit.py",
          "loc": 653,
          "defs": [
            {
              "name": "_is_git_repo",
              "lineno": 24
            },
            {
              "name": "_strip_inline_comment",
              "lineno": 34
            },
            {
              "name": "_parse_glx_run",
              "lineno": 50
            },
            {
              "name": "_validate_mask",
              "lineno": 99
            },
            {
              "name": "_clean_value",
              "lineno": 107
            },
            {
              "name": "_parse_env_file",
              "lineno": 114
            },
            {
              "name": "_parse_env_file",
              "lineno": 127
            },
            {
              "name": "_load_env",
              "lineno": 140
            },
            {
              "name": "_expand_vars_and_user",
              "lineno": 160
            },
            {
              "name": "_resolve_path",
              "lineno": 165
            },
            {
              "name": "_norm_paths_in_env",
              "lineno": 179
            },
            {
              "name": "_log",
              "lineno": 203
            },
            {
              "name": "_fail",
              "lineno": 207
            },
            {
              "name": "_git",
              "lineno": 213
            },
            {
              "name": "_git_top",
              "lineno": 217
            },
            {
              "name": "_rev_parse",
              "lineno": 229
            },
            {
              "name": "_rev_ok",
              "lineno": 234
            },
            {
              "name": "_empty_tree_oid",
              "lineno": 243
            },
            {
              "name": "_detect_base",
              "lineno": 259
            },
            {
              "name": "_dirs_chain_up",
              "lineno": 297
            },
            {
              "name": "_req",
              "lineno": 326
            },
            {
              "name": "_as_int",
              "lineno": 332
            },
            {
              "name": "_as_float01",
              "lineno": 339
            },
            {
              "name": "_redact_env",
              "lineno": 350
            },
            {
              "name": "_module_exists",
              "lineno": 361
            },
            {
              "name": "_module_cmd_from_candidates",
              "lineno": 368
            },
            {
              "name": "_child_env",
              "lineno": 392
            },
            {
              "name": "_run_gateway",
              "lineno": 399
            },
            {
              "name": "_run_mosaic",
              "lineno": 437
            },
            {
              "name": "_send_mail",
              "lineno": 489
            },
            {
              "name": "_should_zip",
              "lineno": 529
            },
            {
              "name": "_writestr_deterministic",
              "lineno": 536
            },
            {
              "name": "_make_zip",
              "lineno": 543
            },
            {
              "name": "main",
              "lineno": 592
            }
          ],
          "classes": []
        },
        {
          "path": "glitchlab/gui/mosaic/tests/metarelation_scaling_test.py",
          "loc": 591,
          "defs": [
            {
              "name": "energy",
              "lineno": 49
            },
            {
              "name": "entropy",
              "lineno": 53
            },
            {
              "name": "build_demo_mosaic",
              "lineno": 70
            },
            {
              "name": "region_indices",
              "lineno": 89
            },
            {
              "name": "region_centroid",
              "lineno": 95
            },
            {
              "name": "region_feats",
              "lineno": 103
            },
            {
              "name": "fuse_meta",
              "lineno": 118
            },
            {
              "name": "_node_label",
              "lineno": 131
            },
            {
              "name": "_group_of",
              "lineno": 149
            },
            {
              "name": "_attach_parents_and_depths",
              "lineno": 167
            },
            {
              "name": "walk",
              "lineno": 171
            },
            {
              "name": "_coords_for_tree",
              "lineno": 190
            },
            {
              "name": "walk",
              "lineno": 198
            },
            {
              "name": "_meta_for_node",
              "lineno": 228
            },
            {
              "name": "ast_nodes_from_code",
              "lineno": 248
            },
            {
              "name": "group_centroids",
              "lineno": 280
            },
            {
              "name": "coords_for_lambda",
              "lineno": 291
            },
            {
              "name": "draw_ast",
              "lineno": 306
            },
            {
              "name": "draw_mosaic",
              "lineno": 317
            },
            {
              "name": "draw_region_frame",
              "lineno": 332
            },
            {
              "name": "draw_fusion",
              "lineno": 342
            },
            {
              "name": "draw_infographic",
              "lineno": 381
            },
            {
              "name": "__init__",
              "lineno": 419
            },
            {
              "name": "_font_step",
              "lineno": 492
            },
            {
              "name": "render",
              "lineno": 502
            },
            {
              "name": "reset_views",
              "lineno": 530
            },
            {
              "name": "repaint",
              "lineno": 535
            },
            {
              "name": "main",
              "lineno": 584
            }
          ],
          "classes": [
            {
              "name": "AstNodeMeta",
              "lineno": 41
            },
            {
              "name": "Mosaic",
              "lineno": 58
            },
            {
              "name": "App",
              "lineno": 418
            }
          ]
        },
        {
          "path": "glitchlab/tests/metarelation_scaling_test.py",
          "loc": 591,
          "defs": [
            {
              "name": "energy",
              "lineno": 49
            },
            {
              "name": "entropy",
              "lineno": 53
            },
            {
              "name": "build_demo_mosaic",
              "lineno": 70
            },
            {
              "name": "region_indices",
              "lineno": 89
            },
            {
              "name": "region_centroid",
              "lineno": 95
            },
            {
              "name": "region_feats",
              "lineno": 103
            },
            {
              "name": "fuse_meta",
              "lineno": 118
            },
            {
              "name": "_node_label",
              "lineno": 131
            },
            {
              "name": "_group_of",
              "lineno": 149
            },
            {
              "name": "_attach_parents_and_depths",
              "lineno": 167
            },
            {
              "name": "walk",
              "lineno": 171
            },
            {
              "name": "_coords_for_tree",
              "lineno": 190
            },
            {
              "name": "walk",
              "lineno": 198
            },
            {
              "name": "_meta_for_node",
              "lineno": 228
            },
            {
              "name": "ast_nodes_from_code",
              "lineno": 248
            },
            {
              "name": "group_centroids",
              "lineno": 280
            },
            {
              "name": "coords_for_lambda",
              "lineno": 291
            },
            {
              "name": "draw_ast",
              "lineno": 306
            },
            {
              "name": "draw_mosaic",
              "lineno": 317
            },
            {
              "name": "draw_region_frame",
              "lineno": 332
            },
            {
              "name": "draw_fusion",
              "lineno": 342
            },
            {
              "name": "draw_infographic",
              "lineno": 381
            },
            {
              "name": "__init__",
              "lineno": 419
            },
            {
              "name": "_font_step",
              "lineno": 492
            },
            {
              "name": "render",
              "lineno": 502
            },
            {
              "name": "reset_views",
              "lineno": 530
            },
            {
              "name": "repaint",
              "lineno": 535
            },
            {
              "name": "main",
              "lineno": 584
            }
          ],
          "classes": [
            {
              "name": "AstNodeMeta",
              "lineno": 41
            },
            {
              "name": "Mosaic",
              "lineno": 58
            },
            {
              "name": "App",
              "lineno": 418
            }
          ]
        },
        {
          "path": "glitchlab/core/pipeline.py",
          "loc": 545,
          "defs": [
            {
              "name": "normalize_preset",
              "lineno": 123
            },
            {
              "name": "_resize_float01",
              "lineno": 196
            },
            {
              "name": "_build_amplitude",
              "lineno": 204
            },
            {
              "name": "_build_edge_mask",
              "lineno": 265
            },
            {
              "name": "build_ctx",
              "lineno": 285
            },
            {
              "name": "_thumb_rgb",
              "lineno": 339
            },
            {
              "name": "_compute_diff",
              "lineno": 350
            },
            {
              "name": "_gather_metrics",
              "lineno": 374
            },
            {
              "name": "_apply_wrapper_mask_amp",
              "lineno": 383
            },
            {
              "name": "apply_pipeline",
              "lineno": 428
            }
          ],
          "classes": [
            {
              "name": "Step",
              "lineno": 105
            },
            {
              "name": "Ctx",
              "lineno": 111
            }
          ]
        }
      ],
      "notes": [
        "GLX: brak .glx/state.json — używam pustych wartości.",
        "GIT: niedostępny — historie Δ ograniczone."
      ]
    },
    "attachments": {
      "schema": "glx.selfdoc.v1",
      "when": "2025-10-02T00:35:27Z",
      "telemetry": {
        "ok": true,
        "error": "",
        "scan_ms": 1296.1275,
        "ast_ms": 1116.6822999999997,
        "files_scanned": 199,
        "mods": 199,
        "defs": 2036,
        "classes": 223,
        "git_ok": false
      }
    }
  },
  "risk_brief": {
    "system": "Jesteś asystentem inżynierskim GlitchLab. Twoja analiza ma być deterministyczna, konkretna, bez wprowadzania losowości. Oceniaj wpływ zmian na architekturę i HUD/Mosaic⇄AST.",
    "user": "Cel: risk_brief. Przygotuj plan refaktoryzacji i mapę ryzyk.\nRepo: . | LOC=41416, modules=199, defs=2036, classes=223.\nZidentyfikuj moduły krytyczne i zaproponuj kroki poprawy spójności.",
    "context": {
      "glx_state": {},
      "git_head": null,
      "recent_commits": [],
      "delta_last": [],
      "top_modules": [
        {
          "path": "glitchlab/gui/mosaic/hybrid_ast_mosaic.py",
          "loc": 1288,
          "defs": [
            {
              "name": "_rng_for_meta",
              "lineno": 149
            },
            {
              "name": "_meta_for",
              "lineno": 157
            },
            {
              "name": "ast_deltas",
              "lineno": 177
            },
            {
              "name": "add",
              "lineno": 185
            },
            {
              "name": "compress_ast",
              "lineno": 235
            },
            {
              "name": "build_mosaic_grid",
              "lineno": 266
            },
            {
              "name": "build_mosaic_hex",
              "lineno": 281
            },
            {
              "name": "build_mosaic",
              "lineno": 297
            },
            {
              "name": "region_ids",
              "lineno": 303
            },
            {
              "name": "_xy_of_idx",
              "lineno": 311
            },
            {
              "name": "_sigmoid",
              "lineno": 318
            },
            {
              "name": "_soft_label",
              "lineno": 328
            },
            {
              "name": "tile_dist",
              "lineno": 333
            },
            {
              "name": "_dm_greedy_oneway",
              "lineno": 350
            },
            {
              "name": "_length_penalty",
              "lineno": 364
            },
            {
              "name": "_pair_cost",
              "lineno": 378
            },
            {
              "name": "D_M",
              "lineno": 403
            },
            {
              "name": "phi_region_for",
              "lineno": 425
            },
            {
              "name": "phi_region_for_balanced",
              "lineno": 433
            },
            {
              "name": "phi_region_for_entropy",
              "lineno": 466
            },
            {
              "name": "near_thr",
              "lineno": 467
            },
            {
              "name": "load_policy_json",
              "lineno": 478
            },
            {
              "name": "make_selector_policy_aware",
              "lineno": 508
            },
            {
              "name": "_sel",
              "lineno": 524
            },
            {
              "name": "centroid",
              "lineno": 543
            },
            {
              "name": "phi_cost",
              "lineno": 551
            },
            {
              "name": "psi_feedback",
              "lineno": 572
            },
            {
              "name": "_neighbors_grid",
              "lineno": 599
            },
            {
              "name": "_neighbors_hex_oddr",
              "lineno": 609
            },
            {
              "name": "_adjacency_indices",
              "lineno": 622
            },
            {
              "name": "_connected_components",
              "lineno": 636
            },
            {
              "name": "mosaic_profile",
              "lineno": 670
            },
            {
              "name": "couple_alpha_beta",
              "lineno": 706
            },
            {
              "name": "distance_ast_mosaic",
              "lineno": 728
            },
            {
              "name": "invariants_check",
              "lineno": 735
            },
            {
              "name": "_selector_from_args",
              "lineno": 758
            },
            {
              "name": "run_once",
              "lineno": 771
            },
            {
              "name": "sweep",
              "lineno": 805
            },
            {
              "name": "sign_test_phi2_better",
              "lineno": 821
            },
            {
              "name": "_ast_summary_for_source_det",
              "lineno": 854
            },
            {
              "name": "_file_selector_filter",
              "lineno": 880
            },
            {
              "name": "run_from_git",
              "lineno": 890
            },
            {
              "name": "_pretty_table",
              "lineno": 1023
            },
            {
              "name": "rowfmt",
              "lineno": 1027
            },
            {
              "name": "line",
              "lineno": 1038
            },
            {
              "name": "cmd_run",
              "lineno": 1047
            },
            {
              "name": "cmd_sweep",
              "lineno": 1067
            },
            {
              "name": "cmd_test",
              "lineno": 1079
            },
            {
              "name": "_normpath_under_project",
              "lineno": 1092
            },
            {
              "name": "_emit_fallback_artifacts",
              "lineno": 1097
            },
            {
              "name": "cmd_from_git_dump",
              "lineno": 1149
            },
            {
              "name": "cmd_from_git",
              "lineno": 1210
            },
            {
              "name": "build_cli",
              "lineno": 1227
            },
            {
              "name": "main",
              "lineno": 1281
            }
          ],
          "classes": [
            {
              "name": "AstNode",
              "lineno": 126
            },
            {
              "name": "AstSummary",
              "lineno": 137
            },
            {
              "name": "Mosaic",
              "lineno": 255
            }
          ]
        },
        {
          "path": "glitchlab/gui/app.py",
          "loc": 913,
          "defs": [
            {
              "name": "init_styles",
              "lineno": 29
            },
            {
              "name": "__init__",
              "lineno": 85
            },
            {
              "name": "publish",
              "lineno": 86
            },
            {
              "name": "subscribe",
              "lineno": 87
            },
            {
              "name": "request",
              "lineno": 88
            },
            {
              "name": "__init__",
              "lineno": 112
            },
            {
              "name": "__init__",
              "lineno": 127
            },
            {
              "name": "_build_ui",
              "lineno": 163
            },
            {
              "name": "_init_sash",
              "lineno": 226
            },
            {
              "name": "_wire_bus",
              "lineno": 251
            },
            {
              "name": "_on_preset_parsed",
              "lineno": 318
            },
            {
              "name": "_load_image_path",
              "lineno": 327
            },
            {
              "name": "_save_image_path",
              "lineno": 374
            },
            {
              "name": "_pil_to_u8",
              "lineno": 393
            },
            {
              "name": "_array_to_pil",
              "lineno": 406
            },
            {
              "name": "run_step",
              "lineno": 420
            },
            {
              "name": "run_preset",
              "lineno": 457
            },
            {
              "name": "_on_progress",
              "lineno": 507
            },
            {
              "name": "_on_run_done",
              "lineno": 519
            },
            {
              "name": "_on_run_error",
              "lineno": 556
            },
            {
              "name": "_update_bottom_from_cache",
              "lineno": 570
            },
            {
              "name": "_update_edit_menu_state",
              "lineno": 578
            },
            {
              "name": "_on_undo",
              "lineno": 586
            },
            {
              "name": "_on_redo",
              "lineno": 615
            },
            {
              "name": "_toggle_left",
              "lineno": 645
            },
            {
              "name": "_toggle_right",
              "lineno": 665
            },
            {
              "name": "_toggle_hud",
              "lineno": 681
            },
            {
              "name": "_toggle_fullscreen",
              "lineno": 697
            },
            {
              "name": "_get_active_layer_pil",
              "lineno": 711
            },
            {
              "name": "_get_composite_np",
              "lineno": 733
            },
            {
              "name": "_refresh_composite",
              "lineno": 748
            },
            {
              "name": "_layers_snapshot",
              "lineno": 761
            },
            {
              "name": "_calc_layers_sig",
              "lineno": 776
            },
            {
              "name": "_publish_layers_snapshot",
              "lineno": 785
            },
            {
              "name": "_on_layers_changed",
              "lineno": 798
            },
            {
              "name": "_on_layer_add",
              "lineno": 804
            },
            {
              "name": "_on_layer_remove",
              "lineno": 837
            },
            {
              "name": "_on_layer_set_active",
              "lineno": 848
            },
            {
              "name": "_on_layer_update",
              "lineno": 857
            },
            {
              "name": "_on_layers_reorder",
              "lineno": 874
            },
            {
              "name": "main",
              "lineno": 894
            }
          ],
          "classes": [
            {
              "name": "EventBus",
              "lineno": 84
            },
            {
              "name": "AppState",
              "lineno": 111
            },
            {
              "name": "App",
              "lineno": 126
            }
          ]
        },
        {
          "path": "glitchlab/gui/mosaic/tests/ast_mosaic_coupled.py",
          "loc": 732,
          "defs": [
            {
              "name": "energy",
              "lineno": 53
            },
            {
              "name": "entropy",
              "lineno": 57
            },
            {
              "name": "_node_label",
              "lineno": 75
            },
            {
              "name": "_attach_parents_and_depths",
              "lineno": 91
            },
            {
              "name": "walk",
              "lineno": 92
            },
            {
              "name": "_group_of",
              "lineno": 111
            },
            {
              "name": "_coords_for_tree",
              "lineno": 119
            },
            {
              "name": "walk",
              "lineno": 122
            },
            {
              "name": "_meta_for_node",
              "lineno": 148
            },
            {
              "name": "ast_nodes_from_code",
              "lineno": 164
            },
            {
              "name": "group_centroids",
              "lineno": 193
            },
            {
              "name": "coords_for_lambda",
              "lineno": 204
            },
            {
              "name": "build_base_mosaic",
              "lineno": 219
            },
            {
              "name": "_norm01",
              "lineno": 231
            },
            {
              "name": "_sobel_mag",
              "lineno": 238
            },
            {
              "name": "mosaic_from_ast",
              "lineno": 255
            },
            {
              "name": "_pos_lam",
              "lineno": 269
            },
            {
              "name": "region_indices",
              "lineno": 296
            },
            {
              "name": "region_centroid",
              "lineno": 302
            },
            {
              "name": "region_feats",
              "lineno": 310
            },
            {
              "name": "fuse_meta",
              "lineno": 322
            },
            {
              "name": "draw_ast",
              "lineno": 331
            },
            {
              "name": "draw_mosaic",
              "lineno": 345
            },
            {
              "name": "draw_region_frame",
              "lineno": 360
            },
            {
              "name": "draw_fusion",
              "lineno": 371
            },
            {
              "name": "draw_infographic",
              "lineno": 406
            },
            {
              "name": "__init__",
              "lineno": 445
            },
            {
              "name": "_font_step",
              "lineno": 540
            },
            {
              "name": "reset_views",
              "lineno": 547
            },
            {
              "name": "render",
              "lineno": 553
            },
            {
              "name": "on_lambda_changed",
              "lineno": 581
            },
            {
              "name": "on_node_changed",
              "lineno": 585
            },
            {
              "name": "recompute_mosaic_from_ast",
              "lineno": 590
            },
            {
              "name": "apply_feedback_and_recompute",
              "lineno": 609
            },
            {
              "name": "feats_at",
              "lineno": 618
            },
            {
              "name": "on_region_changed",
              "lineno": 641
            },
            {
              "name": "on_pick_ast",
              "lineno": 646
            },
            {
              "name": "on_click_any",
              "lineno": 656
            },
            {
              "name": "repaint",
              "lineno": 679
            },
            {
              "name": "main",
              "lineno": 725
            }
          ],
          "classes": [
            {
              "name": "AstNodeMeta",
              "lineno": 44
            },
            {
              "name": "Mosaic",
              "lineno": 62
            },
            {
              "name": "App",
              "lineno": 444
            }
          ]
        },
        {
          "path": "glitchlab/tests/ast_mosaic_coupled.py",
          "loc": 732,
          "defs": [
            {
              "name": "energy",
              "lineno": 53
            },
            {
              "name": "entropy",
              "lineno": 57
            },
            {
              "name": "_node_label",
              "lineno": 75
            },
            {
              "name": "_attach_parents_and_depths",
              "lineno": 91
            },
            {
              "name": "walk",
              "lineno": 92
            },
            {
              "name": "_group_of",
              "lineno": 111
            },
            {
              "name": "_coords_for_tree",
              "lineno": 119
            },
            {
              "name": "walk",
              "lineno": 122
            },
            {
              "name": "_meta_for_node",
              "lineno": 148
            },
            {
              "name": "ast_nodes_from_code",
              "lineno": 164
            },
            {
              "name": "group_centroids",
              "lineno": 193
            },
            {
              "name": "coords_for_lambda",
              "lineno": 204
            },
            {
              "name": "build_base_mosaic",
              "lineno": 219
            },
            {
              "name": "_norm01",
              "lineno": 231
            },
            {
              "name": "_sobel_mag",
              "lineno": 238
            },
            {
              "name": "mosaic_from_ast",
              "lineno": 255
            },
            {
              "name": "_pos_lam",
              "lineno": 269
            },
            {
              "name": "region_indices",
              "lineno": 296
            },
            {
              "name": "region_centroid",
              "lineno": 302
            },
            {
              "name": "region_feats",
              "lineno": 310
            },
            {
              "name": "fuse_meta",
              "lineno": 322
            },
            {
              "name": "draw_ast",
              "lineno": 331
            },
            {
              "name": "draw_mosaic",
              "lineno": 345
            },
            {
              "name": "draw_region_frame",
              "lineno": 360
            },
            {
              "name": "draw_fusion",
              "lineno": 371
            },
            {
              "name": "draw_infographic",
              "lineno": 406
            },
            {
              "name": "__init__",
              "lineno": 445
            },
            {
              "name": "_font_step",
              "lineno": 540
            },
            {
              "name": "reset_views",
              "lineno": 547
            },
            {
              "name": "render",
              "lineno": 553
            },
            {
              "name": "on_lambda_changed",
              "lineno": 581
            },
            {
              "name": "on_node_changed",
              "lineno": 585
            },
            {
              "name": "recompute_mosaic_from_ast",
              "lineno": 590
            },
            {
              "name": "apply_feedback_and_recompute",
              "lineno": 609
            },
            {
              "name": "feats_at",
              "lineno": 618
            },
            {
              "name": "on_region_changed",
              "lineno": 641
            },
            {
              "name": "on_pick_ast",
              "lineno": 646
            },
            {
              "name": "on_click_any",
              "lineno": 656
            },
            {
              "name": "repaint",
              "lineno": 679
            },
            {
              "name": "main",
              "lineno": 725
            }
          ],
          "classes": [
            {
              "name": "AstNodeMeta",
              "lineno": 44
            },
            {
              "name": "Mosaic",
              "lineno": 62
            },
            {
              "name": "App",
              "lineno": 444
            }
          ]
        },
        {
          "path": "glitchlab/.githooks/post-commit.py",
          "loc": 653,
          "defs": [
            {
              "name": "_is_git_repo",
              "lineno": 24
            },
            {
              "name": "_strip_inline_comment",
              "lineno": 34
            },
            {
              "name": "_parse_glx_run",
              "lineno": 50
            },
            {
              "name": "_validate_mask",
              "lineno": 99
            },
            {
              "name": "_clean_value",
              "lineno": 107
            },
            {
              "name": "_parse_env_file",
              "lineno": 114
            },
            {
              "name": "_parse_env_file",
              "lineno": 127
            },
            {
              "name": "_load_env",
              "lineno": 140
            },
            {
              "name": "_expand_vars_and_user",
              "lineno": 160
            },
            {
              "name": "_resolve_path",
              "lineno": 165
            },
            {
              "name": "_norm_paths_in_env",
              "lineno": 179
            },
            {
              "name": "_log",
              "lineno": 203
            },
            {
              "name": "_fail",
              "lineno": 207
            },
            {
              "name": "_git",
              "lineno": 213
            },
            {
              "name": "_git_top",
              "lineno": 217
            },
            {
              "name": "_rev_parse",
              "lineno": 229
            },
            {
              "name": "_rev_ok",
              "lineno": 234
            },
            {
              "name": "_empty_tree_oid",
              "lineno": 243
            },
            {
              "name": "_detect_base",
              "lineno": 259
            },
            {
              "name": "_dirs_chain_up",
              "lineno": 297
            },
            {
              "name": "_req",
              "lineno": 326
            },
            {
              "name": "_as_int",
              "lineno": 332
            },
            {
              "name": "_as_float01",
              "lineno": 339
            },
            {
              "name": "_redact_env",
              "lineno": 350
            },
            {
              "name": "_module_exists",
              "lineno": 361
            },
            {
              "name": "_module_cmd_from_candidates",
              "lineno": 368
            },
            {
              "name": "_child_env",
              "lineno": 392
            },
            {
              "name": "_run_gateway",
              "lineno": 399
            },
            {
              "name": "_run_mosaic",
              "lineno": 437
            },
            {
              "name": "_send_mail",
              "lineno": 489
            },
            {
              "name": "_should_zip",
              "lineno": 529
            },
            {
              "name": "_writestr_deterministic",
              "lineno": 536
            },
            {
              "name": "_make_zip",
              "lineno": 543
            },
            {
              "name": "main",
              "lineno": 592
            }
          ],
          "classes": []
        },
        {
          "path": "glitchlab/gui/mosaic/tests/metarelation_scaling_test.py",
          "loc": 591,
          "defs": [
            {
              "name": "energy",
              "lineno": 49
            },
            {
              "name": "entropy",
              "lineno": 53
            },
            {
              "name": "build_demo_mosaic",
              "lineno": 70
            },
            {
              "name": "region_indices",
              "lineno": 89
            },
            {
              "name": "region_centroid",
              "lineno": 95
            },
            {
              "name": "region_feats",
              "lineno": 103
            },
            {
              "name": "fuse_meta",
              "lineno": 118
            },
            {
              "name": "_node_label",
              "lineno": 131
            },
            {
              "name": "_group_of",
              "lineno": 149
            },
            {
              "name": "_attach_parents_and_depths",
              "lineno": 167
            },
            {
              "name": "walk",
              "lineno": 171
            },
            {
              "name": "_coords_for_tree",
              "lineno": 190
            },
            {
              "name": "walk",
              "lineno": 198
            },
            {
              "name": "_meta_for_node",
              "lineno": 228
            },
            {
              "name": "ast_nodes_from_code",
              "lineno": 248
            },
            {
              "name": "group_centroids",
              "lineno": 280
            },
            {
              "name": "coords_for_lambda",
              "lineno": 291
            },
            {
              "name": "draw_ast",
              "lineno": 306
            },
            {
              "name": "draw_mosaic",
              "lineno": 317
            },
            {
              "name": "draw_region_frame",
              "lineno": 332
            },
            {
              "name": "draw_fusion",
              "lineno": 342
            },
            {
              "name": "draw_infographic",
              "lineno": 381
            },
            {
              "name": "__init__",
              "lineno": 419
            },
            {
              "name": "_font_step",
              "lineno": 492
            },
            {
              "name": "render",
              "lineno": 502
            },
            {
              "name": "reset_views",
              "lineno": 530
            },
            {
              "name": "repaint",
              "lineno": 535
            },
            {
              "name": "main",
              "lineno": 584
            }
          ],
          "classes": [
            {
              "name": "AstNodeMeta",
              "lineno": 41
            },
            {
              "name": "Mosaic",
              "lineno": 58
            },
            {
              "name": "App",
              "lineno": 418
            }
          ]
        },
        {
          "path": "glitchlab/tests/metarelation_scaling_test.py",
          "loc": 591,
          "defs": [
            {
              "name": "energy",
              "lineno": 49
            },
            {
              "name": "entropy",
              "lineno": 53
            },
            {
              "name": "build_demo_mosaic",
              "lineno": 70
            },
            {
              "name": "region_indices",
              "lineno": 89
            },
            {
              "name": "region_centroid",
              "lineno": 95
            },
            {
              "name": "region_feats",
              "lineno": 103
            },
            {
              "name": "fuse_meta",
              "lineno": 118
            },
            {
              "name": "_node_label",
              "lineno": 131
            },
            {
              "name": "_group_of",
              "lineno": 149
            },
            {
              "name": "_attach_parents_and_depths",
              "lineno": 167
            },
            {
              "name": "walk",
              "lineno": 171
            },
            {
              "name": "_coords_for_tree",
              "lineno": 190
            },
            {
              "name": "walk",
              "lineno": 198
            },
            {
              "name": "_meta_for_node",
              "lineno": 228
            },
            {
              "name": "ast_nodes_from_code",
              "lineno": 248
            },
            {
              "name": "group_centroids",
              "lineno": 280
            },
            {
              "name": "coords_for_lambda",
              "lineno": 291
            },
            {
              "name": "draw_ast",
              "lineno": 306
            },
            {
              "name": "draw_mosaic",
              "lineno": 317
            },
            {
              "name": "draw_region_frame",
              "lineno": 332
            },
            {
              "name": "draw_fusion",
              "lineno": 342
            },
            {
              "name": "draw_infographic",
              "lineno": 381
            },
            {
              "name": "__init__",
              "lineno": 419
            },
            {
              "name": "_font_step",
              "lineno": 492
            },
            {
              "name": "render",
              "lineno": 502
            },
            {
              "name": "reset_views",
              "lineno": 530
            },
            {
              "name": "repaint",
              "lineno": 535
            },
            {
              "name": "main",
              "lineno": 584
            }
          ],
          "classes": [
            {
              "name": "AstNodeMeta",
              "lineno": 41
            },
            {
              "name": "Mosaic",
              "lineno": 58
            },
            {
              "name": "App",
              "lineno": 418
            }
          ]
        },
        {
          "path": "glitchlab/core/pipeline.py",
          "loc": 545,
          "defs": [
            {
              "name": "normalize_preset",
              "lineno": 123
            },
            {
              "name": "_resize_float01",
              "lineno": 196
            },
            {
              "name": "_build_amplitude",
              "lineno": 204
            },
            {
              "name": "_build_edge_mask",
              "lineno": 265
            },
            {
              "name": "build_ctx",
              "lineno": 285
            },
            {
              "name": "_thumb_rgb",
              "lineno": 339
            },
            {
              "name": "_compute_diff",
              "lineno": 350
            },
            {
              "name": "_gather_metrics",
              "lineno": 374
            },
            {
              "name": "_apply_wrapper_mask_amp",
              "lineno": 383
            },
            {
              "name": "apply_pipeline",
              "lineno": 428
            }
          ],
          "classes": [
            {
              "name": "Step",
              "lineno": 105
            },
            {
              "name": "Ctx",
              "lineno": 111
            }
          ]
        }
      ],
      "notes": [
        "GLX: brak .glx/state.json — używam pustych wartości.",
        "GIT: niedostępny — historie Δ ograniczone."
      ]
    },
    "attachments": {
      "schema": "glx.selfdoc.v1",
      "when": "2025-10-02T00:35:27Z",
      "telemetry": {
        "ok": true,
        "error": "",
        "scan_ms": 1296.1275,
        "ast_ms": 1116.6822999999997,
        "files_scanned": 199,
        "mods": 199,
        "defs": 2036,
        "classes": 223,
        "git_ok": false
      }
    }
  }
}